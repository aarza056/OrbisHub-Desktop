<!-- OrbisAgent UI Components -->
<!-- Modal dialogs and UI elements for agent management -->
<!-- Author: OrbisHub Team -->
<!-- Created: 2025-11-25 -->

<!-- Agent Details Modal -->
<dialog id="agentDetailsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Agent Details</h2>
            <button class="modal-close" onclick="document.getElementById('agentDetailsModal').close()">&times;</button>
        </div>
        <div class="modal-body">
            <!-- Agent Info -->
            <div class="agent-details-grid">
                <div class="agent-detail-item">
                    <div class="agent-detail-item__label">Machine Name</div>
                    <div class="agent-detail-item__value" id="agentDetailName">â€”</div>
                </div>
                <div class="agent-detail-item">
                    <div class="agent-detail-item__label">Operating System</div>
                    <div class="agent-detail-item__value" id="agentDetailOS">â€”</div>
                </div>
                <div class="agent-detail-item" style="grid-column: 1 / -1;">
                    <div class="agent-detail-item__label">Network Adapters</div>
                    <div class="agent-detail-item__value" id="agentDetailIP" style="font-family: 'Consolas', 'Monaco', monospace; font-size: 12px; line-height: 1.6; white-space: pre-wrap;">â€”</div>
                </div>
                <div class="agent-detail-item">
                    <div class="agent-detail-item__label">Status</div>
                    <div class="agent-detail-item__value" id="agentDetailStatus">â€”</div>
                </div>
                <div class="agent-detail-item">
                    <div class="agent-detail-item__label">Version</div>
                    <div class="agent-detail-item__value" id="agentDetailVersion">â€”</div>
                </div>
                <div class="agent-detail-item">
                    <div class="agent-detail-item__label">Last Seen</div>
                    <div class="agent-detail-item__value" id="agentDetailLastSeen">â€”</div>
                </div>
            </div>
            
            <!-- Tab Navigation -->
            <div class="agent-tabs">
                <button class="agent-tab agent-tab--active" onclick="AgentUI.switchTab('jobs')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Recent Jobs
                </button>
                <button class="agent-tab" onclick="AgentUI.switchTab('builds')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                    </svg>
                    Build History
                </button>
            </div>
            
            <!-- Tab Content -->
            <div class="agent-tab-content">
                <!-- Recent Jobs Tab -->
                <div id="agentTabJobs" class="agent-tab-panel agent-tab-panel--active">
                    <div id="agentDetailJobs" class="agent-jobs-list">
                        <p class="muted" style="text-align:center; padding:20px;">Loading...</p>
                    </div>
                </div>
                
                <!-- Build History Tab -->
                <div id="agentTabBuilds" class="agent-tab-panel">
                    <div id="agentDetailBuilds" class="agent-builds-list">
                        <p class="muted" style="text-align:center; padding:20px;">Loading...</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="document.getElementById('agentDetailsModal').close()">Close</button>
        </div>
    </div>
</dialog>

<!-- Run Job Modal -->
<dialog id="runJobModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Run Job on Agent</h2>
            <button class="modal-close" onclick="document.getElementById('runJobModal').close()">&times;</button>
        </div>
        <div class="modal-body">
            <p style="margin-bottom:20px; color:var(--muted);">
                Execute a script or command on agent: <strong id="runJobAgentName" style="color:var(--text);">â€”</strong>
            </p>
            
            <div>
                <label for="jobType">Job Type</label>
                <select id="jobType">
                    <option value="PowerShell">PowerShell Script</option>
                    <option value="RunScript">Run Script (PS/CMD)</option>
                    <option value="GetSystemInfo">Get System Info</option>
                    <option value="GetProcessList">Get Process List</option>
                </select>
            </div>
            
            <div>
                <label for="jobScript">Script / Command</label>
                <textarea id="jobScript" rows="10" placeholder="Enter PowerShell script or command here...&#10;&#10;Example:&#10;Get-Process | Where-Object {$_.CPU -gt 100}"></textarea>
            </div>
            
            <div class="modal-info-box">
                <strong>ðŸ’¡ Tip:</strong> Scripts execute in PowerShell context on the remote machine. Ensure proper syntax and permissions.
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="document.getElementById('runJobModal').close()">Cancel</button>
            <button class="btn" onclick="AgentUI.submitJob()" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%); color:white; border:none;">
                <span>â–¶</span> Submit Job
            </button>
        </div>
    </div>
</dialog>

<!-- Agent Deployment Guide Modal -->
<dialog id="agentDeploymentModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Deploy OrbisAgent</h2>
            <button class="modal-close" onclick="document.getElementById('agentDeploymentModal').close()">&times;</button>
        </div>
        <div class="modal-body">
            <div>
                <h3>Quick Install (Recommended)</h3>
                <p style="color:var(--muted); margin-bottom:20px;">One command to download and install the agent on a remote Windows PC:</p>
                
                <div class="deployment-steps">
                    <div class="deployment-step">
                        <div class="deployment-step__number deployment-step__number--1">1</div>
                        <div class="deployment-step__content">
                            <h4 class="deployment-step__title">Open PowerShell as Administrator</h4>
                            <p class="deployment-step__description">On the target PC, right-click PowerShell and select "Run as Administrator"</p>
                        </div>
                    </div>
                    
                    <div class="deployment-step">
                        <div class="deployment-step__number deployment-step__number--2">2</div>
                        <div class="deployment-step__content">
                            <h4 class="deployment-step__title">Run Installation Command</h4>
                            <p class="deployment-step__description">Copy and paste this command on the remote PC:</p>
                            <div class="deployment-code-block">
                                <pre class="deployment-code" id="bootstrapCommand">Loading...</pre>
                                <button class="deployment-code-copy" id="copyBootstrapBtn">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="16 1 21 6 8 19 3 19 3 14 16 1"></polyline>
                                    </svg>
                                    Copy
                                </button>
                            </div>
                            <p style="color:var(--muted); font-size:12px; margin-top:8px;">
                                This command will automatically detect your server IP and download the agent.
                            </p>
                        </div>
                    </div>
                    
                    <div class="deployment-step">
                        <div class="deployment-step__number deployment-step__number--3">3</div>
                        <div class="deployment-step__content">
                            <h4 class="deployment-step__title">Verify Installation</h4>
                            <p class="deployment-step__description">The agent will install and start automatically. It will appear in this dashboard within 30 seconds.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top:30px; padding-top:30px; border-top:1px solid var(--border);">
                <h3>Manual Installation</h3>
                <p style="color:var(--muted); margin-bottom:15px;">If you prefer manual installation or the quick install fails:</p>
                
                <div style="margin-bottom:15px;">
                    <h4 style="font-size:14px; margin-bottom:8px;">Step 1: Download Installer</h4>
                    <div class="deployment-code-block">
                        <pre class="deployment-code" id="downloadInstallerCommand">Loading...</pre>
                        <button class="deployment-code-copy" id="copyDownloadInstallerBtn">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="16 1 21 6 8 19 3 19 3 14 16 1"></polyline>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>
                
                <div>
                    <h4 style="font-size:14px; margin-bottom:8px;">Step 2: Run Installer</h4>
                    <div class="deployment-code-block">
                        <pre class="deployment-code" id="runInstallerCommand">Loading...</pre>
                        <button class="deployment-code-copy" id="copyRunInstallerBtn">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="16 1 21 6 8 19 3 19 3 14 16 1"></polyline>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>
            </div>
            
            <div style="margin-top:30px; padding-top:30px; border-top:1px solid var(--border);">
                <h3>What Gets Installed?</h3>
                <ul style="color:var(--muted); font-size:14px; line-height:1.8;">
                    <li>OrbisAgent installed to <code>C:\Program Files\OrbisAgent</code></li>
                    <li>Windows Scheduled Task running as SYSTEM with admin privileges</li>
                    <li>Auto-starts on boot with automatic restart on failure</li>
                    <li>Sends heartbeats every 30 seconds with system metrics</li>
                    <li>Polls for jobs every 5 seconds</li>
                </ul>
            </div>
            
            <div style="margin-top:30px; padding-top:30px; border-top:1px solid var(--border);">
                <h3>Uninstall Agent</h3>
                <p style="color:var(--muted); margin-bottom:15px;">To remove the agent from a PC:</p>
                <div class="deployment-code-block">
                    <pre class="deployment-code" id="uninstallCommand">Loading...</pre>
                    <button class="deployment-code-copy" id="copyUninstallBtn">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="16 1 21 6 8 19 3 19 3 14 16 1"></polyline>
                        </svg>
                        Copy
                    </button>
                </div>
            </div>
            
            <div class="security-warning">
                <div class="security-warning__header">
                    <span class="security-warning__icon">!</span>
                    <strong class="security-warning__title">Security Note</strong>
                </div>
                <p class="security-warning__text">This initial implementation is designed for trusted internal networks. For production use, implement API key authentication, HTTPS encryption, and script validation.</p>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn" onclick="document.getElementById('agentDeploymentModal').close()" style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color:white; border:none;">
                <span>âœ“</span> Got It
            </button>
        </div>
    </div>
</dialog>

<!-- Delete Agent Confirmation Modal -->
<dialog id="deleteAgentModal" class="modal">
    <form method="dialog" class="card card--compact">
        <h2>Delete Agent</h2>
        <p class="muted">Are you sure you want to delete agent "<span id="deleteAgentName"></span>"? This will remove all associated jobs and metrics.</p>
        <menu class="row end">
            <button value="cancel" class="btn btn-ghost">Cancel</button>
            <button value="confirm" id="confirmDeleteAgentBtn" class="btn btn-danger">Delete Agent</button>
        </menu>
    </form>
</dialog>

